{"version":3,"sources":["..\\..\\..\\assets/assets\\jugador.js"],"names":["cc","Class","extends","Component","properties","fondo","default","type","Node","serializable","velocidad","velocidadAngularMaxima","aceleracionAngular","radioVacilacion","radioCentro","destino","anguloDestino","velocidadAngularDestino","aceleracionAngularDestino","deltaAnguloDesaceleracionDestino","velocidadDestinoX","velocidadDestinoY","distanciaPosicion","a","b","Math","sqrt","x","y","onLoad","self","node","position","rotationX","eventManager","addListener","event","EventListener","TOUCH_ONE_BY_ONE","swallowTouches","onTouchBegan","touch","isNaN","getLocation","rotation","anguloRad","PI","atan2","anguloVelocidad","cos","sin","log","onTouchMoved","onTouchEnded","start","update","dt","abs","setPosition"],"mappings":"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","file":"jugador.js","sourceRoot":"..\\..\\..\\assets","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/class.html\r\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/class/index.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/reference/attributes/index.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/life-cycle-callbacks/index.html\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\t\r\n    properties: {\r\n        fondo: {\r\n             default: null, \r\n             type: cc.Node, \r\n             serializable: true,  \r\n         },\r\n\t\t velocidad: {\r\n\t\t\t default: 1.0,\r\n\t\t\t serializable: true,\r\n\t\t },\r\n\t\t velocidadAngularMaxima: {\r\n\t\t\t default: 1.0,\r\n\t\t\t serializable: true,\r\n\t\t },\r\n\t\t aceleracionAngular: {\r\n\t\t\t default: 1.0,\r\n\t\t\t serializable: true,\r\n\t\t },\r\n\t\t radioVacilacion:{\r\n\t\t\t default: 20.0,\r\n\t\t\t serializable: true,\r\n\t\t },\r\n\t\t radioCentro:{\r\n\t\t\t default:40,\r\n\t\t\t serializable: true,\r\n\t\t }\r\n    },\r\n\t\r\n\tdestino: null,\r\n\tanguloDestino: 0,\r\n\tvelocidadAngularDestino: 0,\r\n\taceleracionAngularDestino:0,\r\n\tdeltaAnguloDesaceleracionDestino:0,\r\n\tvelocidadDestinoX:0,\r\n\tvelocidadDestinoY:0,\r\n\t\r\n    // LIFE-CYCLE CALLBACKS:\r\n\tdistanciaPosicion (a, b){\r\n\t\treturn Math.sqrt((a.x-b.x)*(a.x-b.x) + (a.y-b.y)*(a.y-b.y));\r\n\t},\r\n\t\r\n    onLoad: function () {\r\n        var self = this;\r\n\t\t\r\n\t\tself.destino = self.node.position;\r\n\t\tself.anguloDestino = self.node.rotationX;\r\n\t\t\r\n        cc.eventManager.addListener({\r\n            event: cc.EventListener.TOUCH_ONE_BY_ONE,\r\n\t\t\tswallowTouches: false,\r\n            onTouchBegan: function (touch, event) {\t\r\n\t\t\t\t\r\n\t\t\t\tif (isNaN(self.velocidadAngularDestino) ) \r\n\t\t\t\t\tself.velocidadAngularDestino = 0;\r\n\t\t\t\t\r\n\t\t\t\tself.destino = touch.getLocation();\r\n\t\t\t\t\r\n\t\t\t\tif (isNaN(self.node.rotation))\r\n\t\t\t\t\tself.node.rotation = 0;\r\n\t\t\t\t\r\n\t\t\t\tself.node.rotation = (self.node.rotationX +360) % 360;\r\n\t\t\t\t\r\n\t\t\t\t// calcula el angulo contra la vertical x+\r\n\t\t\t\tvar anguloRad = (Math.PI/2 - Math.atan2(self.destino.y - self.fondo.position.y, self.destino.x - self.fondo.position.x) + Math.PI*2) % (Math.PI*2);\r\n\t\t\t\t\r\n\t\t\t\tself.anguloDestino = anguloRad / Math.PI * 180;\r\n\t\t\t\t\r\n\t\t\t\t// intento determinar hacia quÃ© lado girar\r\n\t\t\t\t/*\r\n\t\t\t\t\tEj 1 \r\n\t\t\t\t\tdestino = 270\r\n\t\t\t\t\tnodo = 30\r\n\t\t\t\t\tdestino - nodo >180 -> gira contrareloj\r\n\t\t\t\t\tEj 2\r\n\t\t\t\t\tDestino = 30\r\n\t\t\t\t\tnodo = 270\r\n\t\t\t\t\tDestino - nodo < -180 - gira reloj\r\n \t\t\t\t*/\r\n\t\t\t\t\r\n\t\t\t\tif (self.node.rotationX % 360 + 360 - self.anguloDestino > 180)\r\n\t\t\t\t{\r\n\t\t\t\t\tself.aceleracionAngularDestino = self.aceleracionAngular;\r\n\t\t\t\t\tself.deltaAnguloDesaceleracionDestino = (self.anguloDestino - self.node.rotationX % 360)/2\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tself.aceleracionAngularDestino = -self.aceleracionAngular;\r\n\t\t\t\t\tself.deltaAnguloDesaceleracionDestino = (self.node.rotationX % 360 + 360 - self.anguloDestino)/2\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// calcula el angulo contra la vertical x+\r\n\t\t\t\tvar anguloVelocidad = Math.atan2(self.destino.y - self.node.position.y, self.destino.x - self.node.position.x);\r\n\t\t\t\t\r\n\t\t\t\tself.velocidadDestinoX = Math.cos(anguloVelocidad) * self.velocidad;\r\n\t\t\t\tself.velocidadDestinoY = Math.sin(anguloVelocidad) * self.velocidad;\r\n\t\t\t\t\r\n\t\t\t\tcc.log(self.destino, self.anguloDestino, self.velocidadDestinoX, self.velocidadDestinoY);\r\n\t\t\t\t\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\t//Trigger when moving touch\r\n\t\t\tonTouchMoved: function (touch, event) {\t\r\n\r\n\t\t\t\tcc.log('onTouchMoved');\r\n\t\t\t\t\r\n\t\t\t},\r\n\t\t\t//Process the touch end event\r\n\t\t\tonTouchEnded: function (touch, event) {\r\n\r\n\t\t\t\tcc.log('onTouchEnded');\r\n\t\t\t\t\r\n\t\t\t}\r\n        }, self.node);\r\n    },\r\n\t\r\n    start () {\r\n\r\n    },\r\n\t\r\n\tupdate (dt){\r\n\t\tif (isNaN(this.velocidadAngularDestino) || isNaN(this.velocidadDestinoX) || isNaN(this.velocidadDestinoY))\r\n\t\t{\r\n\t\t\t\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tif (Math.abs(((this.node.rotationX + 360) % 360 + 360) % 540 - ((this.anguloDestino + 360)% 360 + 360) % 540)  < this.deltaAnguloDesaceleracionDestino)\r\n\t\t\t{\r\n\t\t\t\tthis.aceleracionAngularDestino = -this.aceleracionAngularDestino;\r\n\t\t\t\tthis.deltaAnguloDesaceleracionDestino = -1;  // queda deshabilitado\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis.velocidadAngularDestino += this.aceleracionAngularDestino;\r\n\t\t\t\r\n\t\t\tif (Math.abs((this.node.rotation + 360) % 540 - (this.anguloDestino + 360) % 540) < 5)\r\n\t\t\t{\r\n\t\t\t\tthis.aceleracionAngularDestino = 0;\r\n\t\t\t\tthis.velocidadAngularDestino = 0;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis.node.rotation = this.node.rotationX + this.velocidadAngularDestino * dt;\r\n\t\t\t\r\n\t\t\tif (this.distanciaPosicion(this.node.position, this.destino) > this.radioVacilacion)\r\n\t\t\t\tthis.node.setPosition(this.node.position.x + this.velocidadDestinoX * dt, this.node.position.y + this.velocidadDestinoY * dt);\r\n\t\t\t\r\n\t\t\tcc.log(this.velocidadAngularDestino);\r\n\t\t\tcc.log(this.velocidadDestinoY);\r\n\t\t}\r\n\t},\r\n});\r\n"]}